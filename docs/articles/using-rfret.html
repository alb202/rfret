<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using rfret • rfret</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rfret</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Using rfret</h1>
                        <h4 class="author">Guillaume Gaullier</h4>
            
            <h4 class="date">2017-05-23</h4>
          </div>

    
    
<div class="contents">
<p>This documentation explains how to use the functions provided by the <code>rfret</code> package to analyze FRET titration experiments and determine a macromolecular interaction’s binding constant (Kd). Examples using real-life datasets are presented and discussed.</p>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<div id="fret-data-analysis-workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#fret-data-analysis-workflow" class="anchor"></a>FRET data analysis workflow</h2>
<p>Analysis of FRET data can be broken down into the following steps, each of which <code>rfret</code> provides functions for:</p>
<ol style="list-style-type: decimal">
<li>inspect raw data to detect possible outliers (function <code>inspect_raw_data</code>);</li>
<li>average fluorescence intensities across technical replicates, if such replicates were measured (function <code>average_technical_replicates</code>);</li>
<li>correct FRET signal of the titration experiment, using signal from blank experiments which contain no donor and no acceptor (function <code>correct_fret_signal</code>);</li>
<li>guess initial values for the parameters of the quadratic binding equation (<code>kd</code>, <code>fret_min</code> and <code>fret_max</code>; function <code>guess_quadratic_parameters</code>);</li>
<li>fit the quadratic binding equation to the experimental data, to determine the binding constant Kd (function <code>fit_binding_model</code>).</li>
</ol>
<p>All these functions are designed to work independently, therefore you can skip some of these steps (for example, you might not have technical replicates to average, or you might perform your own signal correction using a different method and software). However, they are also designed to produce outputs that can be directly used as input for the next function, making the whole analysis free of any need for more data reformatting.</p>
</div>
<div id="raw-data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#raw-data-format" class="anchor"></a>Raw data format</h2>
<p><code>rfret</code> is designed such that the user doesn’t have to manually do any calculation or any edit to the numbers: such manipulations in spreadsheet programs are not only time-consuming, they are also error-prone and encourage the bad habit of doing calculations in the same file that contains the raw data (which should remain unaltered, to ensure reproducibility of the analysis).</p>
<p>The raw data must be formatted like the following example (first 6 rows of a real-life dataset):</p>
<table class="table">
<thead><tr class="header">
<th align="left">Well.Row</th>
<th align="right">Well.Col</th>
<th align="left">Content</th>
<th align="right">fret_channel</th>
<th align="right">acceptor_channel</th>
<th align="right">donor_channel</th>
<th align="right">concentration</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">E</td>
<td align="right">1</td>
<td align="left">blank_1</td>
<td align="right">27507</td>
<td align="right">180706</td>
<td align="right">1527</td>
<td align="right">1000.00</td>
</tr>
<tr class="even">
<td align="left">E</td>
<td align="right">2</td>
<td align="left">blank_1</td>
<td align="right">12797</td>
<td align="right">81296</td>
<td align="right">1118</td>
<td align="right">500.00</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="right">3</td>
<td align="left">blank_1</td>
<td align="right">7095</td>
<td align="right">45215</td>
<td align="right">1103</td>
<td align="right">250.00</td>
</tr>
<tr class="even">
<td align="left">E</td>
<td align="right">4</td>
<td align="left">blank_1</td>
<td align="right">4161</td>
<td align="right">23985</td>
<td align="right">951</td>
<td align="right">125.00</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="right">5</td>
<td align="left">blank_1</td>
<td align="right">2743</td>
<td align="right">15361</td>
<td align="right">899</td>
<td align="right">62.50</td>
</tr>
<tr class="even">
<td align="left">E</td>
<td align="right">6</td>
<td align="left">blank_1</td>
<td align="right">1755</td>
<td align="right">9282</td>
<td align="right">984</td>
<td align="right">31.25</td>
</tr>
</tbody>
</table>
<p>Most (if not all) plate readers have an “export to CSV” feature, which is best suited to save raw data in a format usable by <code>rfret</code>. If offered a choice between “plate layout” and “table view”, choose “table view”: this will export the data in a format similar to the previous table.</p>
<p>The <code>Well.Row</code> and <code>Well.Col</code> columns present in this example dataset were created by the plate reader software used to produce this dataset, but <code>rfret</code> will simply ignore them and any other columns except the following ones (these can come in any order, but must have the exact following case sensitive names):</p>
<ul>
<li><code>Content</code></li>
<li><code>fret_channel</code></li>
<li><code>acceptor_channel</code></li>
<li><code>donor_channel</code></li>
<li><code>concentration</code></li>
</ul>
<p>Therefore, you will need to either edit these column names manually when you save your data, or set up your plate reader software to write these column names automatically for you. You might need to add the <code>concentration</code> column manually, if your plate reader software is not aware of your titration series.</p>
<p>This data preparation step is the only one for which you will need to use a spreadsheet program (you can also edit the CSV file in a simple text editor, but a spreadsheet displays this sort of data in a way that is much easier to navigate).</p>
</div>
</div>
<div id="analyzing-a-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#analyzing-a-dataset" class="anchor"></a>Analyzing a dataset</h1>
<div id="inspect-raw-data" class="section level2">
<h2 class="hasAnchor">
<a href="#inspect-raw-data" class="anchor"></a>Inspect raw data</h2>
<p>By its very nature, a FRET experiment provides built-in controls for the correct preparation of the titration samples. In a typical experiment, the donor-labeled molecule is kept constant at a low concentration, and the acceptor-labeled molecule is titrated across a wide concentration series prepared by serial dilutions. In these conditions, inspecting the fluorescence intensities in the donor and acceptor channels provides an easy way to check that these concentrations meet the expected ones.</p>
<p>To use <code>rfret</code>, we first need to load the package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rfret)</code></pre></div>
<p>The function <code>inspect_raw_data</code> takes a raw dataset and outputs, for each one of the donor, acceptor and FRET channels, a plot of the fluorescence intensity across the titration series. Warnings will appear, because two of these plots have a logarithmic scale on the <code>x</code> axis, and some datapoints have zero as <code>x</code> coordinate (samples with no acceptor-labeled molecule).</p>
<p>Let’s look at an example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ttn &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"titration_1"</span>, <span class="st">"titration_2"</span>)
plots_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect_raw_data.html">inspect_raw_data</a></span>(<span class="dt">raw_data =</span> fret_good, <span class="dt">titrations =</span> ttn)
plots_<span class="dv">1</span><span class="op">$</span>donor</code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis

## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<p><img src="using-rfret_files/figure-html/Inspect%20raw%20data-1.png" width="672"></p>
<p>In the donor channel plot, all fluorescence intensities should be equal, since the donor-labeled molecule is present at the same concentration in all samples. Fluorescence detection is sensitive enough to detect very small pipetting errors, therefore this plot is a good way to detect such errors. The line represents the mean of all fluorescence intensities in the donor channel, and the shaded area represents +/- 10 % of the mean. If all data points fall into this shaded area, as in this example (except one slightly outside), then the pipetting of the donor-labeled molecule achieved a good precision.</p>
<p>The blank experiment doesn’t contain the donor-labeled molecule, and has near-zero fluorescence intensities across the entire titration series, as expected.</p>
<p>Let’s look at the acceptor channel plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plots_<span class="dv">1</span><span class="op">$</span>acceptor</code></pre></div>
<p><img src="using-rfret_files/figure-html/Acceptor%20plot-1.png" width="672"></p>
<p>If the serial dilution was performed with good precision, all data points should cluster around a straight line, as in this example.</p>
<p>The FRET channel plot quickly tells if the data contains useful signal, and if it is worth completing the analysis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plots_<span class="dv">1</span><span class="op">$</span>fret</code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<p><img src="using-rfret_files/figure-html/FRET%20plot-1.png" width="672"></p>
<p>The titration and blank experiments should have visible differences in fluorescence intensity at some point in the titration series. If their data points perfectly overlap, it means the data doesn’t contain any useful signal (as we will see in a later example).</p>
</div>
<div id="average-technical-replicates" class="section level2">
<h2 class="hasAnchor">
<a href="#average-technical-replicates" class="anchor"></a>Average technical replicates</h2>
<p>The function <code>average_technical_replicates</code> takes a raw dataset, and the names of the replicates associated to the titration and blank experiments (column <code>Content</code> in the raw dataset). These names are chosen by the user at the data saving stage right after the experiment. In our example dataset, these names are <code>blank_1</code>, <code>blank_2</code>, <code>titration_1</code> and <code>titration_2</code>, and each one has 24 data points:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(fret_good<span class="op">$</span>Content)</code></pre></div>
<pre><code>##     blank_1     blank_2 titration_1 titration_2 
##          24          24          24          24</code></pre>
<p>We already set the names of the titration experiments above, so we can reuse them and only need to define the blank names. We will store the resulting reduced dataset in a variable to use it in subsequent steps of the analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">blk &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"blank_1"</span>, <span class="st">"blank_2"</span>)
reduced_dataset &lt;-<span class="st"> </span><span class="kw"><a href="../reference/average_technical_replicates.html">average_technical_replicates</a></span>(<span class="dt">raw_data =</span> fret_good,
                                                <span class="dt">titrations =</span> ttn,
                                                <span class="dt">blanks =</span> blk)</code></pre></div>
<p>The reduced datasets now have only two names, with 24 data points each:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(reduced_dataset<span class="op">$</span>Content)</code></pre></div>
<pre><code>##     blank titration 
##        24        24</code></pre>
</div>
<div id="correct-fret-signal" class="section level2">
<h2 class="hasAnchor">
<a href="#correct-fret-signal" class="anchor"></a>Correct FRET signal</h2>
<p>The function <code>correct_fret_signal</code> applies the correction described in the following references:</p>
<ul>
<li>Hieb AR <em>et al</em> (2012) Fluorescence Strategies for High-Throughput Quantification of Protein Interactions. <em>Nucleic Acids Research</em> 40 (5): e33 <a href="https://doi.org/10.1093/nar/gkr1045" class="uri">https://doi.org/10.1093/nar/gkr1045</a>
</li>
<li>Winkler DD <em>et al</em> (2012) Quantifying Chromatin-Associated Interactions: The HI-FI System. In <em>Methods in Enzymology</em> pp 243–274. Elsevier. <a href="https://doi.org/10.1016/B978-0-12-391940-3.00011-1" class="uri">https://doi.org/10.1016/B978-0-12-391940-3.00011-1</a>
</li>
</ul>
<p>It takes a reduced dataset from <code>average_technical_replicates</code> (or any similarly formatted dataset) and outputs the corrected FRET signal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">final_dataset &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_fret_signal.html">correct_fret_signal</a></span>(reduced_dataset)
final_dataset</code></pre></div>
<pre><code>##    concentration fret_corrected
## 1   1.000000e+03     4187.65301
## 2   5.000000e+02     4079.15319
## 3   2.500000e+02     3968.91208
## 4   1.250000e+02     2837.45927
## 5   6.250000e+01     2531.60067
## 6   3.125000e+01     1513.43434
## 7   1.562500e+01     1308.37658
## 8   7.812500e+00      763.51358
## 9   3.906250e+00      431.15523
## 10  1.953125e+00      371.52433
## 11  9.765625e-01        0.00000
## 12  4.882812e-01      358.93902
## 13  2.441406e-01       35.97851
## 14  1.220703e-01       74.38332
## 15  6.103516e-02      102.68790
## 16  3.051758e-02       74.76773
## 17  1.525879e-02      104.05945
## 18  7.629395e-03      152.99099
## 19  3.814697e-03       65.84552
## 20  1.907349e-03       14.26907</code></pre>
</div>
<div id="batch-processing" class="section level2">
<h2 class="hasAnchor">
<a href="#batch-processing" class="anchor"></a>Batch processing</h2>
<p>The two previous functions, <code>average_technical_replicates</code> and <code>correct_fret_signal</code>, can not only be used independently on individual datasets: they can also be applied in a batch processing mode on all raw data files present in one folder. This involves a wrapper function called <code>batch_process</code>. Here is an example of the use of this function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setwd</span>(<span class="st">"/path/to/raw/data/files"</span>)
<span class="kw"><a href="../reference/batch_process.html">batch_process</a></span>(<span class="dt">input =</span> <span class="st">"."</span>,
              <span class="dt">titrations =</span> <span class="kw">c</span>(<span class="st">"titration_1"</span>, <span class="st">"titration_2"</span>),
              <span class="dt">blanks =</span> <span class="kw">c</span>(<span class="st">"blank_1"</span>, <span class="st">"blank_2"</span>),
              <span class="dt">skip_lines =</span> <span class="dv">4</span>,
              <span class="dt">output =</span> <span class="st">"/save/processed/data/here"</span>)</code></pre></div>
<p>If no output directory is specified, the function returns all corrected datasets as a list of dataframes, which can then be accessd and manipulated programmatically.</p>
</div>
<div id="guess-initial-values-of-the-binding-model-equation-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#guess-initial-values-of-the-binding-model-equation-parameters" class="anchor"></a>Guess initial values of the binding model equation parameters</h2>
<p>The function <code>guess_parameters</code> takes a corrected dataset from <code>correct_fret_signal</code> (or any similarly formatted dataset) and outputs initial values for <code>kd</code>, <code>fret_min</code> and <code>fret_max</code>.</p>
<p>These values are based on very naive guesses: <code>fret_min</code> and <code>fret_max</code> are simply the minimum and maximum fluorescence intensities present in the final corrected dataset, and <code>kd</code> is the value of <code>concentration</code> of the datapoint that has the closest FRET value to <code>(fret_max - fret_min) / 2</code> (fluorescence intensity at half-maximum).</p>
<p>These naive guesses are most of the time close enough to the actual value to make the fit converge properly. If the fitting procedure fails using these initial values, one can visually find a better approximation of <code>kd</code> by plotting the corrected FRET data as a function of the titration series. Alternatively, failure to fit the data can reveal data quality problems.</p>
<p>Let’s try that on our example dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">guessed_params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/guess_parameters.html">guess_parameters</a></span>(final_dataset)
guessed_params</code></pre></div>
<pre><code>## $kd
## [1] 62.5
## 
## $fret_min
## [1] 0
## 
## $fret_max
## [1] 4187.653</code></pre>
</div>
<div id="curve-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#curve-fitting" class="anchor"></a>Curve fitting</h2>
<p>The last step involves the function <code>fit_binding_model</code>, which is simply a wrapper around R’s <code>stats::nls</code> function. It takes a corrected dataset (output of <code>correct_fret_signal</code>), a binding model (currently available models are: <code>hyperbola</code>, <code>quadratic</code> and <code>quadratic_homodimer</code>), a list of initial values for <code>kd</code>, <code>fret_min</code> and <code>fret_max</code> (either provided by the user, or directly the output of <code>guess_parameters</code>), and the fixed concentration of donor-labeled molecule. It returns an <code>nls</code> object that can be further examined with standard functions (like <code>summary</code>) or used as input for <code>make_figure</code>.</p>
<p>The function <code>make_figure</code> takes an <code>nls</code> object and the associated corrected fret data, and returns a result table, a plot of the binding curve, a residual plot, and a figure with those two plots combined.</p>
<p>Let’s finish analyzing our example dataset, display the result table and the final figure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fit_binding_model.html">fit_binding_model</a></span>(<span class="dt">corrected_data =</span> final_dataset,
                            <span class="dt">binding_model =</span> quadratic,
                            <span class="dt">parameters =</span> guessed_params,
                            <span class="dt">donor_concentration =</span> <span class="dv">10</span>)
my_results &lt;-<span class="st"> </span><span class="kw"><a href="../reference/make_figure.html">make_figure</a></span>(final_dataset, my_fit)
my_results<span class="op">$</span>results</code></pre></div>
<pre><code>##       term   estimate  std.error
## 1       kd   48.41484   6.294323
## 2 fret_min  116.84493  46.089282
## 3 fret_max 4437.96247 130.070102</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_results<span class="op">$</span>final_figure</code></pre></div>
<p><img src="using-rfret_files/figure-html/Fit%20binding%20model-1.png" width="672"></p>
</div>
</div>
<div id="detecting-outliers" class="section level1">
<h1 class="hasAnchor">
<a href="#detecting-outliers" class="anchor"></a>Detecting outliers</h1>
<p>The previous example featured a good dataset, making the analysis straightforward. The following examples show how the function <code>inspect_raw_data</code> can be used to detect outliers.</p>
<div id="saturated-fluorescence-reads" class="section level2">
<h2 class="hasAnchor">
<a href="#saturated-fluorescence-reads" class="anchor"></a>Saturated fluorescence reads</h2>
<p>All fluorescence detection instruments have a defined dynamic range, and will not report any fluorescence intensity higher than a certain arbitrary number when reading an intensity that exceeds this threshold. In these situations, the instrument should warn the user right away, but the resulting dataset can still be saved and meaningless results can be obtained if these outliers go unnoticed.</p>
<p>The function <code>inspect_raw_data</code> can optionnaly detect the presence of such reads in a raw dataset and report it to the user. For this, it needs the value of a saturated fluorescence read. All datasets discussed in this document were collected using an instrument that saturates at a fluorescence intensity value of 260000. Let’s inspect another dataset that contains such values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inspection &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect_raw_data.html">inspect_raw_data</a></span>(fret_saturated_reads,
                               <span class="dt">highest_signal =</span> <span class="dv">260000</span>)</code></pre></div>
<pre><code>## Warning: Acceptor channel contains saturated reads. Measure again with a
## lower gain for this channel.</code></pre>
<p>The function gives a warning indicating which channel contains saturated reads. The user then has the opportunity to inspect the numbers and possibly exclude outliers from the subsequent analysis, or even repeat the measurement with a lower gain. Collecting new data avoiding saturation of the fluorescence detector is indeed necessary to get meaningful results.</p>
<p>The function also returns <code>saturated_reads = TRUE</code>, which can be used to programmatically test for the presence of saturated reads in a raw dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">inspection<span class="op">$</span>saturated_reads</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>No further checks are performed on the number provided for <code>highest_signal</code>, and the function will return meaningless information if this number does not match the actual saturation value of the instrument. As every instrument will have a different arbitrary saturation value, the user is responsible for finding and using the correct number.</p>
</div>
<div id="donor-outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#donor-outliers" class="anchor"></a>Donor outliers</h2>
<p>Let’s inspect another different dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plots_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect_raw_data.html">inspect_raw_data</a></span>(fret_donor_outliers, ttn)
plots_<span class="dv">2</span><span class="op">$</span>donor</code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis

## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<p><img src="using-rfret_files/figure-html/Donor%20outliers-1.png" width="672"></p>
<p>The donor channel plot clearly shows four obvious outliers in the <code>titration_1</code> series. They are at the 5<sup>th</sup>, 13<sup>th</sup>, 21<sup>st</sup> and 24<sup>th</sup> positions in the titration series. We can easily find them in the raw data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fret_donor_outliers<span class="op">$</span>donor_channel[fret_donor_outliers<span class="op">$</span>Content <span class="op">==</span><span class="st"> "titration_1"</span>][<span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">13</span>, <span class="dv">21</span>, <span class="dv">24</span>)]</code></pre></div>
<pre><code>## [1] 225186 233805 225263 136525</code></pre>
<p>These outliers come from pipetting errors: the three wells that have a higher fluorescence intensity received too much donor-labeled molecule, whereas the one that has a lower fluorescence intensity did not receive enough donor-labeled molecule. Knowing that, one can decide on a rationale basis to exclude these data points from the subsequent analysis.</p>
</div>
<div id="acceptor-outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#acceptor-outliers" class="anchor"></a>Acceptor outliers</h2>
<p>Let’s inspect a third dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plots_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect_raw_data.html">inspect_raw_data</a></span>(fret_acceptor_outliers)
plots_<span class="dv">3</span><span class="op">$</span>acceptor</code></pre></div>
<p><img src="using-rfret_files/figure-html/Acceptor%20outliers-1.png" width="672"></p>
<p>This acceptor channel plot shows that the highest acceptor-labeled molecule concentration is very different between the titration and blank experiments, and between technical replicates. Again, one can decide to exclude data points from the analysis based on this observation.</p>
</div>
</div>
<div id="detecting-usable-fret-signal" class="section level1">
<h1 class="hasAnchor">
<a href="#detecting-usable-fret-signal" class="anchor"></a>Detecting usable FRET signal</h1>
<p>The previous two datasets are not ideal, because they contain outliers in either the donor channel or the acceptor channel. Yet, they contain useful FRET signal and can yield binding curves and binding constants. You now know how to analyze them to find out what these binding curves look like, and what the associated binding constants are.</p>
<p>In this last example, we will see how the function <code>inspect_raw_data</code> can help quickly detecting usable signal in a FRET dataset. Let’s inspect a last dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plots_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect_raw_data.html">inspect_raw_data</a></span>(fret_bad)
plots_<span class="dv">4</span><span class="op">$</span>fret</code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<p><img src="using-rfret_files/figure-html/No%20FRET%20signal-1.png" width="672"></p>
<p>Something looks wrong here: there is very little visible difference in fluorescence intensity in the FRET channel between the titration and blank experiments.</p>
<p>For comparison, this is how this same plot looked for the first dataset we inspected:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plots_<span class="dv">1</span><span class="op">$</span>fret</code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous x-axis</code></pre>
<p><img src="using-rfret_files/figure-html/Detectable%20FRET%20signal-1.png" width="672"></p>
<p>The last example dataset doesn’t look like it contains any signal. We can verify that by plotting the corrected data and see if we get anything that looks like a binding curve:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bad_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/average_technical_replicates.html">average_technical_replicates</a></span>(fret_bad, ttn, blk)
bad_data_corr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/correct_fret_signal.html">correct_fret_signal</a></span>(bad_data)
<span class="kw">library</span>(ggplot2)
<span class="kw">qplot</span>(concentration, fret_corrected, <span class="dt">data =</span> bad_data_corr, <span class="dt">log =</span> <span class="st">"x"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="using-rfret_files/figure-html/Flat%20binding%20curve-1.png" width="672"></p>
<p>This dataset doesn’t yield any binding curve, and trying to fit this data would either fail or give a completely meaningless value for Kd.</p>
</div>
<div id="automatic-report-generation" class="section level1">
<h1 class="hasAnchor">
<a href="#automatic-report-generation" class="anchor"></a>Automatic report generation</h1>
<p>Used in combination with <a href="http://rmarkdown.rstudio.com">R Markdown</a>, <code>rfret</code> makes the process of data analysis fully integrated with the lab notebook record keeping process.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#overview">Overview</a><ul class="nav nav-pills nav-stacked">
<li><a href="#fret-data-analysis-workflow">FRET data analysis workflow</a></li>
      <li><a href="#raw-data-format">Raw data format</a></li>
      </ul>
</li>
      <li>
<a href="#analyzing-a-dataset">Analyzing a dataset</a><ul class="nav nav-pills nav-stacked">
<li><a href="#inspect-raw-data">Inspect raw data</a></li>
      <li><a href="#average-technical-replicates">Average technical replicates</a></li>
      <li><a href="#correct-fret-signal">Correct FRET signal</a></li>
      <li><a href="#batch-processing">Batch processing</a></li>
      <li><a href="#guess-initial-values-of-the-binding-model-equation-parameters">Guess initial values of the binding model equation parameters</a></li>
      <li><a href="#curve-fitting">Curve fitting</a></li>
      </ul>
</li>
      <li>
<a href="#detecting-outliers">Detecting outliers</a><ul class="nav nav-pills nav-stacked">
<li><a href="#saturated-fluorescence-reads">Saturated fluorescence reads</a></li>
      <li><a href="#donor-outliers">Donor outliers</a></li>
      <li><a href="#acceptor-outliers">Acceptor outliers</a></li>
      </ul>
</li>
      <li><a href="#detecting-usable-fret-signal">Detecting usable FRET signal</a></li>
      <li><a href="#automatic-report-generation">Automatic report generation</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Guillaume Gaullier.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
